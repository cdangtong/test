/*
   2014-2017 Nicholas K. Dionysopoulos / Akeeba Ltd
 @license     GNU GPL version 3 or later
*/
if("undefined"==typeof Solo)var Solo={};"undefined"==typeof Solo.Fsfilters&&(Solo.Fsfilters={translations:{},currentRoot:null,loadingGif:""});Solo.Fsfilters.activeRootChanged=function(){var c=document.getElementById("active_root"),b={};b.root=c.options[c.selectedIndex].value;b.crumbs=[];b.node="";Solo.Fsfilters.load(b)};Solo.Fsfilters.load=function(c){c.verb="list";c={akaction:JSON.stringify(c)};Solo.System.doAjax(c,function(c){Solo.Fsfilters.render(c)},null,!1,15E3)};
Solo.Fsfilters.toggle=function(c,b,f,g){null==g&&(g=!0);if(null!=b){if(!0==Solo.System.data.get(b,"loading",!1))return;Solo.System.data.set(b,"loading",!0);var d=b;g&&(d=b.querySelector("span"));Solo.System.data.set(b,"iconClass",d.className);d.className="fa ak-toggle-button ak-toggle-button-spinning fa-square";var e=setInterval(function(){"undefined"==typeof d.className?clearInterval(e):-1!=d.className.indexOf("fa-square-o")?(Solo.System.addClass(d,"fa-square"),Solo.System.removeClass(d,"fa-square-o")):
(Solo.System.removeClass(d,"fa-square"),Solo.System.addClass(d,"fa-square-o"))},250);Solo.System.data.set(b,"akeebatimer",e)}var a={akaction:JSON.stringify(c)};Solo.System.doAjax(a,function(a){if(null!==b){var e=Solo.System.data.get(b,"akeebatimer");clearInterval(e);d.className=Solo.System.data.get(b,"iconClass");Solo.System.data.set(b,"iconClass",null);Solo.System.data.set(b,"loading",null)}!0==a.success?(null!=b&&g&&(!0==a.newstate?(Solo.System.removeClass(b,"btn-default"),Solo.System.addClass(b,
"btn-warning")):(Solo.System.removeClass(b,"btn-warning"),Solo.System.addClass(b,"btn-default"))),null!=f&&f(a,b)):(null!=f&&f(a,b),Solo.System.modalErrorHandler(Solo.Fsfilters.translations.COM_AKEEBA_FILEFILTERS_LABEL_UIERRORFILTER.replace("%s",c.node)))},function(a){if(null!=b){var c=Solo.System.data.get(b,"akeebatimer");clearInterval(c);d.className=Solo.System.data.get(b,"iconClass");Solo.System.data.set(b,"iconClass");Solo.System.data.set(b,"loading")}Solo.System.params.errorCallback(a)},!0,15E3)};
Solo.Fsfilters.render=function(c){Solo.Fsfilters.currentRoot=c.root;crumbs=Solo.Fsfilters.renderCrumbs(c);var b=document.getElementById("folders");b.innerHTML="";0<c.crumbs.length&&Solo.Fsfilters.renderParentFolderElement();if(0<Object.keys(c.folders).length){var f=["directories_all","skipdirs_all","skipfiles_all"],g=document.createElement("div");g.className="folder-header folder-container";for(var d=0;d<f.length;d++){var e=f[d],a=document.createElement("span");a.className="folder-icon-container btn btn-xs btn-default";
a.setAttribute("title",'<div class="tooltip-arrow-up-leftaligned"></div><div>'+Solo.Fsfilters.translations["COM_AKEEBA_FILEFILTERS_TYPE_"+e.toUpperCase()]+"</div>");a.setAttribute("data-akeeba-tooltip-position","right");Solo.Tooltip.simpleTooltip(a);var k="";switch(e){case "directories_all":k="fa-ban";a.insertAdjacentHTML("beforeend",'<span class="ak-toggle-button fa fa-ban"></span>');break;case "skipdirs_all":k="fa-folder-open";a.insertAdjacentHTML("beforeend",'<span class="ak-toggle-button fa fa-folder-open"></span>');
break;case "skipfiles_all":k="fa-file",a.insertAdjacentHTML("beforeend",'<span class="ak-toggle-button fa fa-file"></span>')}Solo.System.addEventListener(a,"click",function(a,c){return function(){var e;-1!=a.className.indexOf("btn-warning")?(Solo.System.removeClass(a,"btn-warning"),Solo.System.addClass(a,"btn-default"),e=!1):(Solo.System.removeClass(a,"btn-default"),Solo.System.addClass(a,"btn-warning"),e=!0);for(var d=1;d<b.children.length;d++){var f=b.children[d].querySelector("span."+c),g=-1!=
f.parentNode.className.indexOf("btn-warning");!e&&!g||e&&g||Solo.System.triggerEvent(f,"click")}}}(a,k));g.appendChild(a)}a=document.createElement("span");a.className="folder-name";a.innerHTML='<span class="pull-left fa fa-long-arrow-left"></span>'+Solo.Fsfilters.translations.COM_AKEEBA_FILEFILTERS_TYPE_APPLYTOALLDIRS;g.appendChild(a);b.appendChild(g)}for(var h in c.folders){if(!c.folders.hasOwnProperty(h))return;g=c.folders[h];uielement=document.createElement("div");uielement.className="folder-container";
f=["directories","skipdirs","skipfiles"];for(d=0;d<f.length;d++){e=f[d];a=document.createElement("span");a.className="btn btn-xs btn-default folder-icon-container";a.setAttribute("title",'<div class="tooltip-arrow-up-leftaligned"></div><div>'+Solo.Fsfilters.translations["COM_AKEEBA_FILEFILTERS_TYPE_"+e.toUpperCase()]+"</div>");switch(e){case "directories":a.insertAdjacentHTML("beforeend",'<span class="ak-toggle-button fa fa-ban"></span>');break;case "skipdirs":a.insertAdjacentHTML("beforeend",'<span class="ak-toggle-button fa fa-folder-open"></span>');
break;case "skipfiles":a.insertAdjacentHTML("beforeend",'<span class="ak-toggle-button fa fa-file"></span>')}a.setAttribute("data-akeeba-tooltip-position","right");Solo.Tooltip.simpleTooltip(a);switch(g[e]){case 2:Solo.System.removeClass(a,"btn-default");Solo.System.addClass(a,"btn-danger");break;case 1:Solo.System.removeClass(a,"btn-default"),Solo.System.addClass(a,"btn-warning");case 0:Solo.System.addEventListener(a,"click",function(a,b,e){return function(){Solo.Fsfilters.toggle({root:c.root,crumbs:crumbs,
node:a,filter:b,verb:"toggle"},e)}}(h,e,a))}uielement.appendChild(a)}a=document.createElement("span");a.textContent=h;a.className="folder-name";Solo.System.addEventListener(a,"click",function(a){return function(){var b=document.createElement("img");b.setAttribute("src",Solo.Fsfilters.loadingGif);b.setAttribute("width",16);b.setAttribute("height",11);b.setAttribute("border",0);b.setAttribute("alt","Loading...");b.style.marginTop="3px";b.style.marginLeft="5px";this.appendChild(b);Solo.Fsfilters.load({root:c.root,
crumbs:crumbs,node:a})}}(h));uielement.appendChild(a);b.appendChild(uielement)}h=document.getElementById("files");h.innerHTML="";0<Object.keys(c.files).length&&(e=document.createElement("div"),e.className="file-header file-container",a=document.createElement("span"),a.className="file-icon-container btn btn-xs btn-default",a.insertAdjacentHTML("beforeend",'<span class="ak-toggle-button fa fa-file-text"></span>'),a.setAttribute("title",'<div class="tooltip-arrow-up-leftaligned"></div><div>'+Solo.Fsfilters.translations.COM_AKEEBA_FILEFILTERS_TYPE_FILES_ALL+
"</div>"),a.setAttribute("data-akeeba-tooltip-position","right"),Solo.Tooltip.simpleTooltip(a),Solo.System.addEventListener(a,"click",function(a){return function(){var a;-1!=this.className.indexOf("btn-warning")?(Solo.System.removeClass(this,"btn-warning"),Solo.System.addClass(this,"btn-default"),a=!1):(Solo.System.removeClass(this,"btn-default"),Solo.System.addClass(this,"btn-warning"),a=!0);for(var b=document.getElementById("files"),c=1;c<b.children.length;c++){var e=b.children[c].querySelector("span.fa-file-text"),
d=-1!=e.parentNode.className.indexOf("btn-warning");!a&&!d||a&&d||Solo.System.triggerEvent(e,"click")}}}(a)),e.appendChild(a),a=document.createElement("span"),a.className="file-name",a.innerHTML='<span class="pull-left fa fa-long-arrow-left"></span>'+Solo.Fsfilters.translations.COM_AKEEBA_FILEFILTERS_TYPE_APPLYTOALLFILES,e.appendChild(a),h.appendChild(e));for(fileName in c.files)if(c.files.hasOwnProperty(fileName)){g=c.files[fileName];uielement=document.createElement("div");uielement.className="file-container";
f=["files"];for(d=0;d<f.length;d++){e=f[d];a=document.createElement("span");a.className="file-icon-container btn btn-xs btn-default";switch(e){case "files":a.insertAdjacentHTML("beforeend",'<span class="ak-toggle-button fa fa-file-text"></span>')}a.setAttribute("title",'<div class="tooltip-arrow-up-leftaligned"></div><div>'+Solo.Fsfilters.translations["COM_AKEEBA_FILEFILTERS_TYPE_"+e.toUpperCase()]+"</div>");a.setAttribute("data-akeeba-tooltip-position","right");Solo.Tooltip.simpleTooltip(a);switch(g[e]){case 2:Solo.System.removeClass(a,
"btn-default");Solo.System.addClass(a,"btn-danger");break;case 1:Solo.System.removeClass(a,"btn-default"),Solo.System.addClass(a,"btn-warning");case 0:Solo.System.addEventListener(a,"click",function(a,b,e){return function(){Solo.Fsfilters.toggle({root:c.root,crumbs:crumbs,node:a,filter:b,verb:"toggle"},e)}}(fileName,e,a))}uielement.appendChild(a)}a=document.createElement("span");a.className="file-name";a.textContent=fileName;uielement.appendChild(a);a=document.createElement("span");a.className="file-size";
a.textContent=g.size;uielement.appendChild(a);h.appendChild(uielement)}};Solo.Fsfilters.nuke=function(){var c={akaction:JSON.stringify({root:Solo.Fsfilters.currentRoot,verb:"reset"})};Solo.System.doAjax(c,function(b){Solo.Fsfilters.render(b)},null,!1,15E3)};Solo.Fsfilters.loadTab=function(c){c={akaction:JSON.stringify({verb:"tab",root:c})};Solo.System.doAjax(c,function(b){Solo.Fsfilters.renderTab(b)},null,!1,15E3)};
Solo.Fsfilters.addRow=function(c,b){var f=Solo.Fsfilters.translations["COM_AKEEBA_FILEFILTERS_TYPE_"+c.type.toUpperCase()];null==f&&(f=c.type);var g=document.createElement("tr");g.className="ak_filter_row";var d=document.createElement("td");g.appendChild(d);d.className="ak_filter_type";d.insertAdjacentHTML("beforeend",f);f=document.createElement("td");g.appendChild(f);f.className="ak_filter_item";d=document.createElement("span");f.appendChild(d);d.className="ak_filter_tab_icon_container btn btn-xs btn-default deletecontainer";
Solo.System.addEventListener(d,"click",function(){if(""==c.node){var b=this.parentNode.parentNode;b.parentNode.removeChild(b)}else b=document.getElementById("active_root"),Solo.Fsfilters.toggle({root:b.options[b.selectedIndex].value,crumbs:[],node:c.node,filter:c.type,verb:"toggle"},this,function(a,b){if(a.success){var c=b.parentNode.parentNode;c.parentNode.removeChild(c)}})});d.insertAdjacentHTML("beforeend",'<span class="ak-toggle-button fa fa-trash-o deletebutton"></span>');d=document.createElement("span");
f.appendChild(d);d.className="ak_filter_tab_icon_container btn btn-xs btn-default editcontainer";Solo.System.addEventListener(d,"click",function(){if(null==this.parentNode.querySelector("input")){this.parentNode.querySelector("span.ak_filter_name").style.display="none";var b=document.createElement("input");b.setAttribute("type","text");b.setAttribute("size",60);b.value=this.parentNode.querySelector("span.ak_filter_name").textContent;this.parentNode.appendChild(b);Solo.System.addEventListener(b,"blur",
function(){var a=this.value,b=this;if(""==a)Solo.System.triggerEvent(b.parentNode.querySelector("span.deletebutton"),"click");else{var d=document.getElementById("active_root"),d={root:d.options[d.selectedIndex].value,crumbs:[],old_node:c.node,new_node:a,filter:c.type,verb:"swap"},e=b.parentNode.querySelector("span.editcontainer");Solo.Fsfilters.toggle(d,e,function(d,f){Solo.System.removeClass(e,"btn-warning");Solo.System.addClass(e,"btn-default");var g=b.parentNode.querySelector("span.ak_filter_name");
g.style.display="inline-block";g.textContent=a;b.parentNode.removeChild(b);c.node=a})}});b.focus()}});d.insertAdjacentHTML("beforeend",'<span class="ak-toggle-button fa fa-pencil-square editbutton"></span>');d=document.createElement("span");d.className="ak_filter_name";d.textContent=c.node;f.appendChild(d);b.appendChild(g)};
Solo.Fsfilters.addNew=function(c){Solo.Fsfilters.addRow({type:c,node:""},document.getElementById("ak_list_table").children[1]);c=document.getElementById("ak_list_table").children[1].children;Solo.System.triggerEvent(c[c.length-1].querySelector("span.editcontainer"),"click")};Solo.Fsfilters.renderTab=function(c){var b=document.getElementById("ak_list_contents");b.innerHTML="";for(var f=0;f<c.length;f++)Solo.Fsfilters.addRow(c[f],b)};
Solo.Fsfilters.renderCrumbs=function(c){var b=[],f=[Solo.Fsfilters.translations.COM_AKEEBA_FILEFILTERS_LABEL_UIROOT,c.root,[],""];b.push(f);var g=0;if(0<c.crumbs.length)for(var d=[],g=0;g<c.crumbs.length;g++){var e=c.crumbs[g],f=[e,c.root,d.slice(0),e];b.push(f);d.push(e)}c=document.getElementById("ak_crumbs");c.innerHTML="";e=null;for(g=0;g<b.length;g++){var e=b[g],f=document.createElement("li"),a=document.createElement("a");a.setAttribute("href","javascript:");e[0]||(e[0]="");e[0]=e[0].replace("&lt;",
"<").replace("&gt;",">");a.textContent=e[0];Solo.System.addEventListener(a,"click",function(a){return function(){var b=document.createElement("img");b.setAttribute("src",Solo.Fsfilters.loadingGif);b.setAttribute("width",16);b.setAttribute("height",11);b.setAttribute("border",0);b.setAttribute("alt","Loading...");b.style.marginTop="5px";b.style.marginLeft="5px";this.appendChild(b);Solo.Fsfilters.load({root:a[1],crumbs:a[2],node:a[3]})}}(e));f.appendChild(a);e=document.createElement("span");e.textContent=
"/";f.appendChild(e);c.appendChild(f)}return d};
Solo.Fsfilters.renderParentFolderElement=function(){var c=document.getElementById("folders"),b=document.createElement("div");Solo.System.addClass(b,"folder-container");b.insertAdjacentHTML("beforeend",'<span class="folder-padding"></span>');b.insertAdjacentHTML("beforeend",'<span class="folder-padding"></span>');b.insertAdjacentHTML("beforeend",'<span class="folder-padding"></span>');b.insertAdjacentHTML("beforeend",'<span class="fa fa-level-up"></span>');var f=document.createElement("span");f.className=
"folder-name folder-up";var g=document.getElementById("ak_crumbs").children;f.textContent="("+g[g.length-2].querySelector("a").textContent+")";Solo.System.addEventListener(f,"click",function(){var b=document.getElementById("ak_crumbs").children;Solo.System.triggerEvent(b[b.length-2].querySelector("a"),"click")});b.appendChild(f);c.appendChild(b)}; //#sourceMappingURL=fsfilters.min.map
